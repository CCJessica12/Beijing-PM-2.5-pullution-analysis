text(facthealth$scores[,1:2],row.names(ushealth),xpd=NA,cex=0.7,col=type,pos=4)
frame()
plot(facthealth$scores[,c(1,3)],type="n",xlab=expression(f[1]),ylab=expression(f[3]),main="US health (factor scores)")
points(facthealth$scores[,c(1,3)],cex=0.9,col=type,pch=type2)
text(facthealth$scores[,c(1,3)],row.names(ushealth),xpd=NA ,cex=0.7,col=type,pos=4)
plot(facthealth$scores[,c(2,3)],type="n",xlab=expression(f[2]),ylab=expression(f[3]),main="US health (factor scores)")
points(facthealth$scores[,c(2,3)],cex=0.9,col=type,pch=type2)
text(facthealth$scores[,c(2,3)],row.names(ushealth),xpd=NA,cex=0.7,col=type,pos=4)
par(opar)
length(row.names(ushealth)[S1])
S1=order(facthealth$scores[,1])
S2=order(facthealth$scores[,2])
S3=order(facthealth$scores[,3])
length(row.names(ushealth)[S1])
S1=order(facthealth$scores[,1])
S2=order(facthealth$scores[,2])
S3=order(facthealth$scores[,3])
cat("Factor 1 \n")
head(row.names(ushealth)[S1],10)
cat("Factor 2 \n")
head(row.names(ushealth)[S2],10)
cat("Factor 3 \n")
head(row.names(ushealth)[S3],10)
S1=order(facthealth$scores[,1])
S2=order(facthealth$scores[,2])
S3=order(facthealth$scores[,3])
cat("Factor 1 \n")
head(row.names(ushealth)[S1],10)
cat("Factor 2 \n")
head(row.names(ushealth)[S2],10)
cat("Factor 3 \n")
head(row.names(ushealth)[S3],10)
lab=colnames(ushealth)[3:9]
opar=par(mfrow=c(2,2))
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",main="US health (varimax)",xlab=expression(q[1]),ylab=expression(q[2]))
ucircle<-cbind(cos((0:360)/180*3.14159),sin((0:360)/180*3.14159))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthealth$loadings[,1:2],labels=lab,col="black")
frame()
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",main="US health (varimax)",xlab=expression(q[1]),ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthealth$loadings[,c(1,3)],labels=lab,col="black")
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",main="US health (varimax)",xlab=expression(q[2]),ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthealth$loadings[,c(2,3)],labels=lab,col="black")
type = as.numeric(ushealth$reg)
type2 = type-1
type2[which(type2==3)]=4
lab=colnames(ushealth)[3:9]
opar=par(mfrow=c(2,2))
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",main="US health (varimax)",xlab=expression(q[1]),ylab=expression(q[2]))
ucircle<-cbind(cos((0:360)/180*3.14159),sin((0:360)/180*3.14159))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthealth$loadings[,1:2],labels=lab,col="black")
frame()
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",main="US health (varimax)",xlab=expression(q[1]),ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthealth$loadings[,c(1,3)],labels=lab,col="black")
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",main="US health (varimax)",xlab=expression(q[2]),ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthealth$loadings[,c(2,3)],labels=lab,col="black")
type = as.numeric(ushealth$reg)
type2 = type-1
type2[which(type2==3)]=4
dev.new()
par(mfrow=c(2,2))
plot(facthealth$scores[,1:2],type="n",xlab=expression(f[1]),ylab=expression(f[2]),main="US health (factor scores)")
points(facthealth$scores[,1:2],cex=0.9,col=type,pch=type2)
text(facthealth$scores[,1:2],row.names(ushealth),xpd=NA,cex=0.7,col=type,pos=4)
frame()
plot(facthealth$scores[,c(1,3)],type="n",xlab=expression(f[1]),ylab=expression(f[3]),main="US health (factor scores)")
points(facthealth$scores[,c(1,3)],cex=0.9,col=type,pch=type2)
text(facthealth$scores[,c(1,3)],row.names(ushealth),xpd=NA ,cex=0.7,col=type,pos=4)
plot(facthealth$scores[,c(2,3)],type="n",xlab=expression(f[2]),ylab=expression(f[3]),main="US health (factor scores)")
points(facthealth$scores[,c(2,3)],cex=0.9,col=type,pch=type2)
text(facthealth$scores[,c(2,3)],row.names(ushealth),xpd=NA,cex=0.7,col=type,pos=4)
par(opar)
facthealth$scores[,1]
order(facthealth$scores[,1])
sort(facthealth$scores[,1])
cat("Factor 1 \n")
head(sort(facthealth$scores[,1]),10)
head(row.names(ushealth)[S1],10)
cat("Factor 2 \n")
head(sort(facthealth$scores[,2],10)
cat("Factor 3 \n")
cat("Factor 1 \n")
head(sort(facthealth$scores[,1]),10)
cat("Factor 2 \n")
head(sort(facthealth$scores[,2]),10)
cat("Factor 3 \n")
head(sort(facthealth$scores[,3]),10)
cat("Factor 1 \n")
head(sort(facthealth$scores[,1]),10)
cat("\n")
cat("Factor 2 \n")
head(sort(facthealth$scores[,2]),10)
cat("\n")
cat("Factor 3 \n")
head(sort(facthealth$scores[,3]),10)
?sort
cat("Factor 1 \n")
head(sort(facthealth$scores[,1], decreasing = T),10)
cat("\n")
cat("Factor 2 \n")
head(sort(facthealth$scores[,2], decreasing = T),10)
cat("\n")
cat("Factor 3 \n")
head(sort(facthealth$scores[,3], decreasing = T),10)
cat("Factor 1 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = T),5)
cat("Low Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = T),5)
cat("Low Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = T),5)
cat("Low Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = F),5)
cat("\n")
cat("Factor 1 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = T),5)
cat("Low Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = T),5)
cat("Low Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = F),5)
cat("\n")
cat("Factor 1 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = F),5)
cat("\n")
load("uscrime.rda")
load("uscrime.rda")
factcrime = factanal(~murder+rape+robbery+assault+burglary+larceny+autotheft,factors=3,rotation="varimax",scores="regression",data=uscrime)
facttable = cbind(factcrime$loadings, (1 - factcrime$uniquenesses),factcrime$uniqueness)
colnames(facttable) = c("q1", "q2", "q3", "Communalities", "Specific variances")
print(round(facttable,4))
factcrime$PVAL
print(round(facttable,4))
names(ushealth)
names(uscrime)
facthealth
cat("Factor 1 \n")
cat("High Mortality rate:\n")
head(sort(factcrime$scores[,1], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(factcrime$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 1 \n")
cat("High crime rate(murder, assault, rape):\n")
head(sort(factcrime$scores[,1], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(factcrime$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High Mortality rate(larceny, burglary, rape):\n")
head(sort(factcrime$scores[,2], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(factcrime$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High Mortality rate(autotheft, robbery, burglary):\n")
head(sort(factcrime$scores[,3], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(factcrime$scores[,3], decreasing = F),5)
cat("\n")
cat("Factor 1 \n")
cat("High crime rate(murder, assault, rape):\n")
head(sort(factcrime$scores[,1], decreasing = T),5)
cat("\nLow crime rate:\n")
head(sort(factcrime$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High cirme rate(larceny, burglary, rape):\n")
head(sort(factcrime$scores[,2], decreasing = T),5)
cat("\nLow crime rate:\n")
head(sort(factcrime$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High crime rate(autotheft, robbery, burglary):\n")
head(sort(factcrime$scores[,3], decreasing = T),5)
cat("\nLow crime rate:\n")
head(sort(factcrime$scores[,3], decreasing = F),5)
cat("\n")
load("vocabulary.rda")
names(vocabulary)
names(vocabulary)
factvocab = factanal(vocabulary[,1:4], factors=1,scores="Bartlett")
facttable = cbind(factvocab$loadings, (1 - factvocab$uniquenesses),factvocab$uniqueness)
colnames(facttable) = c("q1", "Communalities", "Specific variances")
print(round(facttable,4))
factvocab$PVAL
print(round(facttable,4))
plot(factanal(voc, factors=1,scores="Bartlett")$scores,type="n",xlab="",ylab="Score")
plot(factanal(vocabulary[,1:4],
factors=1,scores="Bartlett")$scores,type="n",xlab="",ylab="Score")
text(factanal(vocabulary[,1:4], factors=1,scores="Bartlett")$scores,rownames(voc))
text(factanal(vocabulary[,1:4], factors=1,scores="Bartlett")$scores,rownames(vocabulary[,1:4]))
plot(factanal(vocabulary[,1:4],
factors=1,scores="Bartlett")$scores,type="n",xlab="",ylab="Score")
text(factanal(vocabulary[,1:4], factors=1,scores="Bartlett")$scores,rownames(vocabulary[,1:4]))
factvocab = factanal(vocabulary[,1:4], factors=2,scores="Bartlett")
factvocab = factanal(vocabulary[,1:4], factors=1,scores="Bartlett")
factvocab$PVAL
facttable = cbind(factvocab$loadings, (1 - factvocab$uniquenesses),factvocab$uniqueness)
colnames(facttable) = c("q1", "Communalities", "Specific variances")
print(round(facttable,4))
plot(factanal(vocabulary[,1:4],
factors=1,scores="Bartlett")$scores,type="n",xlab="",ylab="Score")
text(factanal(vocabulary[,1:4], factors=1,scores="Bartlett")$scores,rownames(vocabulary[,1:4]))
load("athletic.rda")
# main calculation
facthle = factanal(athletic,factors=3,rotation="varimax",scores="regression")
#print(facthle)
facthle$PVAL
facttable = cbind(facthle$loadings, (1 - facthle$uniquenesses),facthle$uniqueness)
colnames(facttable) = c("loading1", "loading2", "loading3", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
lab = colnames(athletic)
par(mfrow=c(2,2))
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",
main="Athletic (varimax)",
xlab=expression(q[1]),
ylab=expression(q[2]))
ucircle = cbind(cos((0:360)/180*3.14159),sin((0:360)/180*3.14159))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthle$loadings[,1:2],labels=lab,col="black",xpd=NA) # use 2 factors
frame()
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",
main="Athletic (varimax)",
xlab=expression(q[1]),
ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthle$loadings[,c(1,3)],labels=lab,col="black",xpd=NA) # use factor 1 and 3
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",
main="Athletic (varimax)",
xlab=expression(q[2]),
ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthle$loadings[,c(2,3)],labels=lab,col="black",xpd=NA) # use factor 2 and 3
dev.new()
par(mfrow=c(2,2))
plot(facthle$scores[,1:2],type="n",xlab=expression(f[1]),ylab=expression(f[2]),main="Athletic (factor scores)")
text(facthle$scores[,1:2],row.names(athletic),cex=0.7,xpd=NA)
frame()
plot(facthle$scores[,c(1,3)],type="n",xlab=expression(f[1]),ylab=expression(f[3]),main="Athletic (factor scores)")
text(facthle$scores[,c(1,3)],row.names(athletic),cex=0.7,xpd=NA)
plot(facthle$scores[,c(2,3)],type="n",xlab=expression(f[2]),ylab=expression(f[3]),main="Athletic (factor scores)")
text(facthle$scores[,c(2,3)],row.names(athletic),cex=0.7,xpd=NA)
o1=order(facthle$scores[,1])
o2=order(facthle$scores[,2])
o3=order(facthle$scores[,3])
cat("Factor 1 \n")
row.names(athletic)[o1]
cat("Factor 2 \n")
row.names(athletic)[o2]
cat("Factor 3 \n")
row.names(athletic)[o3]
load("ushealth.rda")
facthealth=factanal(~acc+card+canc+pul+pneu+diab+liv,factors=3,rotation="varimax",scores="regression",data=ushealth)
facthealth$PVAL
communalities = (1 - facthealth$uniquenesses)
facttable = cbind(facthealth$loadings,communalities,facthealth$uniqueness)
colnames(facttable) = c("q1", "q2", "q3", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
cat("Factor 1\n")
cat("High Mortality rate(card, canc, diab)\n")
head(sort(facthealth$scores[,1], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High Mortality rate(pneu):\n")
head(sort(facthealth$scores[,2], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High Mortality rate(liv):\n")
head(sort(facthealth$scores[,3], decreasing = T),5)
cat("\nLow Mortality rate:\n")
head(sort(facthealth$scores[,3], decreasing = F),5)
cat("\n")
load("uscrime.rda")
factcrime = factanal(~murder+rape+robbery+assault+burglary+larceny+autotheft,factors=3,rotation="varimax",scores="regression",data=uscrime)
factcrime$PVAL
facttable = cbind(factcrime$loadings, (1 - factcrime$uniquenesses),factcrime$uniqueness)
colnames(facttable) = c("q1", "q2", "q3", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
cat("Factor 1 \n")
cat("High crime rate(murder, assault, rape):\n")
head(sort(factcrime$scores[,1], decreasing = T),5)
cat("\nLow crime rate:\n")
head(sort(factcrime$scores[,1], decreasing = F),5)
cat("\n")
cat("Factor 2 \n")
cat("High cirme rate(larceny, burglary, rape):\n")
head(sort(factcrime$scores[,2], decreasing = T),5)
cat("\nLow crime rate:\n")
head(sort(factcrime$scores[,2], decreasing = F),5)
cat("\n")
cat("Factor 3 \n")
cat("High crime rate(autotheft, robbery, burglary):\n")
head(sort(factcrime$scores[,3], decreasing = T),5)
cat("\nLow crime rate:\n")
head(sort(factcrime$scores[,3], decreasing = F),5)
cat("\n")
load("vocabulary.rda")
names(vocabulary)
factvocab = factanal(vocabulary[,1:4], factors=1,scores="Bartlett")
factvocab$PVAL
facttable = cbind(factvocab$loadings, (1 - factvocab$uniquenesses),factvocab$uniqueness)
colnames(facttable) = c("q1", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
plot(factanal(vocabulary[,1:4],
factors=1,scores="Bartlett")$scores,type="n",xlab="",ylab="Score")
text(factanal(vocabulary[,1:4], factors=1,scores="Bartlett")$scores,rownames(vocabulary[,1:4]))
load("athletic.rda")
# main calculation
facthle = factanal(athletic,factors=3,rotation="varimax",scores="regression")
#print(facthle)
facthle$PVAL
facttable = cbind(facthle$loadings, (1 - facthle$uniquenesses),facthle$uniqueness)
colnames(facttable) = c("loading1", "loading2", "loading3", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
lab = colnames(athletic)
par(mfrow=c(2,2))
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",
main="Athletic (varimax)",
xlab=expression(q[1]),
ylab=expression(q[2]))
ucircle = cbind(cos((0:360)/180*3.14159),sin((0:360)/180*3.14159))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthle$loadings[,1:2],labels=lab,col="black",xpd=NA) # use 2 factors
frame()
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",
main="Athletic (varimax)",
xlab=expression(q[1]),
ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthle$loadings[,c(1,3)],labels=lab,col="black",xpd=NA) # use factor 1 and 3
plot(c(-1.1,1.1),c(-1.1,1.1),type="n",
main="Athletic (varimax)",
xlab=expression(q[2]),
ylab=expression(q[3]))
points(ucircle,type="l",lty="dotted")
abline(h = 0)
abline(v = 0)
text(facthle$loadings[,c(2,3)],labels=lab,col="black",xpd=NA) # use factor 2 and 3
dev.new()
par(mfrow=c(2,2))
plot(facthle$scores[,1:2],type="n",xlab=expression(f[1]),ylab=expression(f[2]),main="Athletic (factor scores)")
text(facthle$scores[,1:2],row.names(athletic),cex=0.7,xpd=NA)
frame()
plot(facthle$scores[,c(1,3)],type="n",xlab=expression(f[1]),ylab=expression(f[3]),main="Athletic (factor scores)")
text(facthle$scores[,c(1,3)],row.names(athletic),cex=0.7,xpd=NA)
plot(facthle$scores[,c(2,3)],type="n",xlab=expression(f[2]),ylab=expression(f[3]),main="Athletic (factor scores)")
text(facthle$scores[,c(2,3)],row.names(athletic),cex=0.7,xpd=NA)
o1=order(facthle$scores[,1])
o2=order(facthle$scores[,2])
o3=order(facthle$scores[,3])
# Factor 1:
row.names(athletic)[o1]
# Factor 2:
row.names(athletic)[o2]
#Factor 3:
row.names(athletic)[o3]
load("ushealth.rda")
facthealth=factanal(~acc+card+canc+pul+pneu+diab+liv,factors=3,rotation="varimax",scores="regression",data=ushealth)
facthealth$PVAL
communalities = (1 - facthealth$uniquenesses)
facttable = cbind(facthealth$loadings,communalities,facthealth$uniqueness)
colnames(facttable) = c("q1", "q2", "q3", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
# Factor 1
# High Mortality rate(card, canc, diab):
head(sort(facthealth$scores[,1], decreasing = T),5)
# Low Mortality rate:
head(sort(facthealth$scores[,1], decreasing = F),5)
# Factor 2
# High Mortality rate(pneu):
head(sort(facthealth$scores[,2], decreasing = T),5)
# Low Mortality rate:
head(sort(facthealth$scores[,2], decreasing = F),5)
#Factor 3:
# High Mortality rate(liv):
head(sort(facthealth$scores[,3], decreasing = T),5)
# Low Mortality rate:
head(sort(facthealth$scores[,3], decreasing = F),5)
load("uscrime.rda")
factcrime = factanal(~murder+rape+robbery+assault+burglary+larceny+autotheft,factors=3,rotation="varimax",scores="regression",data=uscrime)
factcrime$PVAL
facttable = cbind(factcrime$loadings, (1 - factcrime$uniquenesses),factcrime$uniqueness)
colnames(facttable) = c("q1", "q2", "q3", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
#Factor 1
# High crime rate(murder, assault, rape):
head(sort(factcrime$scores[,1], decreasing = T),5)
# Low crime rate:
head(sort(factcrime$scores[,1], decreasing = F),5)
#Factor 2
#High cirme rate(larceny, burglary, rape):
head(sort(factcrime$scores[,2], decreasing = T),5)
# Low crime rate:
head(sort(factcrime$scores[,2], decreasing = F),5)
# Factor 3
# High crime rate(autotheft, robbery, burglary):
head(sort(factcrime$scores[,3], decreasing = T),5)
# Low crime rate:
head(sort(factcrime$scores[,3], decreasing = F),5)
load("vocabulary.rda")
names(vocabulary)
factvocab = factanal(vocabulary[,1:4], factors=1,scores="Bartlett")
factvocab$PVAL
facttable = cbind(factvocab$loadings, (1 - factvocab$uniquenesses),factvocab$uniqueness)
colnames(facttable) = c("q1", "Communalities", "Specific variances")
print(round(facttable,4))
# xtable(facttable,digits=4)
plot(factanal(vocabulary[,1:4],
factors=1,scores="Bartlett")$scores,type="n",xlab="",ylab="Score")
text(factanal(vocabulary[,1:4], factors=1,scores="Bartlett")$scores,rownames(vocabulary[,1:4]))
library(data.table)
library(tseries)
library(itsmr)
library(forecast)
library(dplyr)
library(plyr)
pm = fread("PRSA_data_2010.1.1-2014.12.31.csv")
setwd("~/Desktop/GR5223 Multivariate Stat Inference/Beijing-PM-2.5-pullution-analysis")
path = "~/Desktop/GR5223 Multivariate Stat Inference/Beijing-PM-2.5-pullution-analysis"
pm = fread(paste0(path,"/data/PRSA_data_2010.1.1-2014.12.31.csv"))
na_check = apply(is.na(pm),2,sum);na_check
del = which(is.na(pm$pm2.5) == TRUE)
pm[del,"pm2.5"] = 0
#pm_delete_na = pm[-del,]
#apply(is.na(pm_delete_na),2,sum)
#pm25 = pm_delete_na[,-1]
pm25 = pm[,-1]
apply(is.na(pm25),2,sum);na_check
pm25_time = as.data.frame(pm25[,c(1,2,3,4,5)])
aggregate_pm = function(x){
return(mean(x$pm2.5))
}
pm_daily  = ddply(pm25_time, .(year,month,day), aggregate_pm)
colnames(pm_daily) = c("year","month","day","pm2.5")
pm_daily = pm_daily$pm2.5
pm_monthly = ddply(pm25_time, .(year,month), aggregate_pm)
colnames(pm_monthly) = c("year","month","pm2.5")
pm_monthly = pm_monthly$pm2.5
plot(1:length(pm_daily),ts(pm_daily),type="l",pch=22,lty=1,pty=2,col = "grey",
ylab="PM2.5 concentration(ug/m^3)",xlab = "")
